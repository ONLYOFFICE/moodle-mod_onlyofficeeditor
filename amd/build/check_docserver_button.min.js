/**
 * @module     mod_onlyofficeeditor/check_docserver_button
 * @copyright  2025 Ascensio System SIA <integration@onlyoffice.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 **/
define("mod_onlyofficeeditor/check_docserver_button",["core/notification","mod_onlyofficeeditor/repository"],(function(Notification,Repository){const fields={docserverurl:"documentserverurl",secret:"documentserversecret",jwtheader:"jwtheader",internalurl:"documentserverinternal",storageurl:"storageurl",disableverifyssl:"disable_verify_ssl"},validationElements=[],checkDocumentServerConnection=async event=>{event.preventDefault(),await Repository.checkDocumentServerConnection(document.getElementById("id_s_onlyofficeeditor_documentserverurl").value,document.getElementById("id_s_onlyofficeeditor_documentserversecret").value,document.getElementById("id_s_onlyofficeeditor_jwtheader").value,document.getElementById("id_s_onlyofficeeditor_documentserverinternal").value,document.getElementById("id_s_onlyofficeeditor_storageurl").value,document.getElementById("id_s_onlyofficeeditor_disable_verify_ssl").checked).then((response=>{if(console.log(response),clearValidationOutput(),"success"===response.status)Notification.addNotification({message:"Connection is stable.",type:"success"});else if("error"===response.status){Notification.addNotification({message:"Connection error.",type:"error"});for(const error of response.errors)"general"===error.field?Notification.addNotification({message:error.message,type:"error"}):highlightErrorField(error)}})).catch((error=>{console.error("Error checking Document Server connection:",error),Notification.addNotification({message:"Unexpected error ocurred while checking connection.",type:"error"})}))},highlightErrorField=error=>{const fieldForm=document.getElementById("admin-"+fields[error.field]),fieldSetting=fieldForm?fieldForm.querySelector(".form-setting"):null;if(fieldSetting){const errorElement=document.createElement("div");errorElement.innerHTML='<span class="error">'+error.message+"</span>",fieldSetting.prepend(errorElement),validationElements.push(errorElement)}},clearValidationOutput=()=>{for(const element of validationElements)element.remove();validationElements.length=0;document.getElementById("user-notifications").innerHTML=""};return{init:function(){const checkButton=document.querySelector("button[data-action='check-documentserver-connection']");checkButton&&checkButton.addEventListener("click",checkDocumentServerConnection)}}}));

//# sourceMappingURL=check_docserver_button.min.js.map