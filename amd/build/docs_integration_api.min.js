/**
 * @module mod_onlyofficeeditor/docs_integration_api
 * @copyright  2025 Ascensio System SIA <integration@onlyoffice.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 **/
define("mod_onlyofficeeditor/docs_integration_api",[],(function(){const SCRIPT_ID="onlyofficeeditor-docsapi",_createScriptTag=(id,url,resolve,reject)=>{const script=document.createElement("script");return script.id=id,script.type="text/javascript",script.src=url.endsWith("/")?url+"web-apps/apps/api/documents/api.js":url+"/web-apps/apps/api/documents/api.js",script.async=!0,script.onload=()=>{script.removeAttribute("loading"),resolve(null)},script.onerror=error=>{script.removeAttribute("loading"),reject(error)},script.setAttribute("loading",""),script};return{loadDocsApi:function(url){return new Promise((function(resolve,reject){try{if("undefined"!=typeof DocsAPI&&null!==DocsAPI)return resolve(null);if(!url||""===url.trim())return reject("Document server URL is not provided");const existingScript=document.getElementById(SCRIPT_ID);if(existingScript){let intervalHandler=setInterval((()=>{if(!existingScript.getAttribute("loading")){clearInterval(intervalHandler),"undefined"!=typeof DocsAPI&&null!==DocsAPI&&resolve(null);const script=_createScriptTag(SCRIPT_ID,url,resolve,reject);existingScript.remove(),document.body.appendChild(script)}}),500)}else{const script=_createScriptTag(SCRIPT_ID,url,resolve,reject);document.body.appendChild(script)}}catch(error){return console.error("Error loading Document Server API:",error),reject(error)}}))},removeDocsApi:function(){return new Promise((function(resolve,reject){try{const script=document.getElementById(SCRIPT_ID);return script&&script.remove(),"undefined"==typeof DocsAPI||null===DocsAPI?resolve(null):(DocsAPI=null,resolve(null))}catch(error){return console.error("Error removing Document Server API:",error),reject(error)}}))}}}));

//# sourceMappingURL=docs_integration_api.min.js.map