/**
 * Contain the logic for the add save as modal.
 *
 * @module    mod_onlyofficeeditor/modal_saveas
 * @copyright  2024 Ascensio System SIA <integration@onlyoffice.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 **/
define("mod_onlyofficeeditor/modal_saveas",["jquery","core/modal","core/templates","core/str"],(function($,Modal,Templates,Str){var displayNotification=function(error,type){require(["core/notification"],(function(notification){require(["core/str"],(function(str){var errorIsAvailable=str.get_string(error,"onlyofficeeditor");$.when(errorIsAvailable).done((function(localizedStr){notification.addNotification({message:localizedStr,type:type})}))}))}))};const SaveAsDialog=Object;SaveAsDialog.modal=null,SaveAsDialog.build=async(cmid,courseid,saveAsData)=>{var self=this;Str.get_strings([{key:"saveastitle",component:"mod_onlyofficeeditor"}]).then((async _ref=>{let[title]=_ref;this.modal=await Modal.create({title:title,show:!0}),$.ajax(M.cfg.wwwroot+"/mod/onlyofficeeditor/onlyofficeeditorapi.php?apiType=sections&cmid=".concat(cmid),{type:"GET",dataType:"json",data:{courseid:courseid}}).done((response=>{var sections=response.sections,body=Templates.render("mod_onlyofficeeditor/modal_saveas_sections_list",{sections:sections}),footer=Templates.render("mod_onlyofficeeditor/modal_saveas_footer");self.modal.setBody(body),self.modal.setFooter(footer),self.modal.getRoot().on("click",SELECTORS.SECTION,(e=>{var selected=self.modal.selectedSection;void 0!==selected&&self.modal.getBody().find("#saveas-section-"+selected)[0].classList.remove("onlyofficeeditor-saveas-section-selected");self.modal.getFooter().find(SELECTORS.BUTTON)[0].removeAttribute("disabled"),e.target.classList.add("onlyofficeeditor-saveas-section-selected"),self.modal.selectedSection=parseInt(e.target.id.split("-")[2])})),self.modal.getRoot().on("click",SELECTORS.BUTTON,(()=>{saveAsData.section=self.modal.selectedSection,$.ajax(M.cfg.wwwroot+"/mod/onlyofficeeditor/onlyofficeeditorapi.php?apiType=saveas&cmid=".concat(cmid),{type:"POST",dataType:"json",data:saveAsData}).done((()=>{displayNotification("saveassuccess","success")})).fail((()=>{displayNotification("saveaserror","error")})).always((()=>{self.modal.hide()}))}))})).fail((()=>{displayNotification("saveaserror","error")}))}))};var SELECTORS={SECTION:".onlyofficeeditor-saveas-section",BUTTON:"#onlyofficeeditor-saveas-button"};return SaveAsDialog}));

//# sourceMappingURL=modal_saveas.min.js.map